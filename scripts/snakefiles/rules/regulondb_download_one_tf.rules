# Set parameters
if not "qsub" in config.keys():
    sys.exit("The parameter qsub must be defined in the config file")

if not "TF" in config["metadata"].keys():
    sys.exit("Parameters config['metadata']['TF'] must be defined in the config file to perform the RegulonDB download.")

# Rule
rule RegulonDB_download_one_TF:
    """Get TFBS and PSSM from RegulonDB webservice for a given TF or list of TFs.
        
    Required parameters:
        config["qsub"]
        config["metadata"]["TF"] 

    Author: Claire Rioualen
    """
#    input: 
    output: 
        tfbs="{dir}/{TF}/{TF}_sites.fa",
        pssm= "{dir}/{TF}/{TF}_matrix.tf"
    params: qsub = config["qsub"] + " -e {dir}/{TF}/{TF}_qsub.err -o {dir}/{TF}/{TF}_qsub.out"
    log: "{dir}/{TF}/{TF}_index.log"
    benchmark: "{dir}/{TF}/{TF}_benchmark.tab"
#    conda: ""
    shell:"""
wget -nc http://regulondb.ccg.unam.mx/webresources/tools/getTFBS?tfObject={wildcards.TF} -O {output.tfbs}
wget -nc http://regulondb.ccg.unam.mx/webresources/tools/getPSSM?tfObject={wildcards.TF} -O {output.pssm}
"""
